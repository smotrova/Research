!+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

!----------------------Programa dla nah. eigenvalues--------------------------------------

!-----------------------------rezultati vivodatsa v file----------------------------------

!++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 


SUBROUTINE kappa_gamma (n, k0, kn)
IMPLICIT NONE 


INTEGER      m,  i

INTEGER 	 n

REAL(8) ::   PI=3.141592653589D0

REAL(8)      alfa 				!Refraction index

INTEGER      i1,i0, m1

REAL(8)      gama0, kapa0, k0, kn, alfa1,l

REAL(8)      x(2)

REAL(8)      eps

COMMON /ALFA/ alfa
COMMON /arg/ l
COMMON /Accuracy/ eps 

!*********************************************************************************************


	i0= int(( k0*alfa/Pi-n/2+0.250D0)) 			! H-pol
	i1=int(( kn*alfa/Pi-n/2+0.250D0))			! H-pol
	
!***********************************************************************************************

alfa1=alfa 

OPEN (unit=2, file='KG_Hpol.dat')

DO m=i0, i1

		kapa0=Pi*(2*m+n-0.50D0)/2/alfa			! H-pol
		 

!*****************************************************************************************
!			print*,''
!			print*,'!!! INPUT !!!'	
!			print*,''	
!			print*,'m=',m
!			print*, 'alfa=', alfa
!			print*,'kapa0=', kapa0

!			print*,''
!			print*,'!!! OUTPUT !!!'	
!			print*,''	

		CALL get_roots(x, n, kapa0, alfa)

			alfa=alfa1

!			print*, 'kapa=', x(1)
!			print*, 'gama=', -x(2)
!			print*,''
!			print*,''	
!*****************************************************************************************

!IF (x(1) > PI/l/dsqrt(alfa*alfa-1)/2)	THEN

		IF ( x(1)>0 .and. x(2)<0) THEN

			WRITE(2,'(2X,E13.6, 3X,E13.6, 3X,E13.6 )'), x(1), dlog10(-x(2))

		END IF
	
!END IF


END DO

CLOSE(2)

print*,''	
print*,'The results output in file KG_Hpol.dat ' 

!****************************************************************************************


END SUBROUTINE kappa_gamma

!****************************************************************************************
!****************************************************************************************
!****************************************************************************************




